<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - QMS</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/Web/select2/dist/css/select2.min.css" />
    <link rel="stylesheet" href="~/css/site.css" />

    <script type="text/javascript" src="~/lib/jquery/dist/jquery.min.js"></script>
    <script type="text/javascript" src="~/lib/jquery/dist/jquery.js"></script>

    <script src="~/lib/knockout/dist/knockout.js" type="text/javascript"></script>

    <link href="~/css/devextreme/dx.common.css" rel="stylesheet" />
    <link href="~/css/devextreme/dx.light.css" rel="stylesheet" />


    <script type="text/javascript" src="~/js/jszip.min.js"></script>
    @*<script src="~/js/quill.min.js"></script>*@
    <script src="https://cdnjs.cloudflare.com/ajax/libs/devextreme-quill/1.1.5/dx-quill.min.js"></script>
    <script type="text/javascript" src="~/js/devextreme/dx.all.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.min.js"></script>
    <script src="~/lib/jquery-toast-plugin/dist/jquery.toast.min.js"></script>

    <script src="~/js/devextreme/cldr.js"></script>
    <script src="~/js/devextreme/cldr/event.js"></script>
    <script src="~/js/devextreme/cldr/supplemental.js"></script>
    <script src="~/js/devextreme/cldr/unresolved.js"></script>

    <script src="~/js/devextreme/globalize.js"></script>
    <script src="~/js/devextreme/globalize/message.js"></script>
    <script src="~/js/devextreme/globalize/number.js"></script>
    <script src="~/js/devextreme/globalize/currency.js"></script>
    <script src="~/js/devextreme/globalize/date.js"></script>

    <script src="~/js/devextreme/vectormap-data/world.js"></script>
    <script src="~/lib/devextreme-aspnet-data/js/dx.aspnet.data.js"></script>
    <script src="~/js/devextreme/aspnet/dx.aspnet.mvc.js"></script>


    <script src="~/Web/select2/dist/js/select2.min.js"></script>


    @*Reporting Links*@
    <script src="~/lib/xtrareportsjs/js/dx-analytics-core.min.js"></script>
    <script src="~/lib/xtrareportsjs/js/dx-webdocumentviewer.min.js"></script>
    <link href="~/lib/xtrareportsjs/css/dx-analytics.common.min.css" rel="stylesheet" />
    <link href="~/lib/xtrareportsjs/css/dx-analytics.light.min.css" rel="stylesheet" />
    <link href="~/lib/xtrareportsjs/css/dx-webdocumentviewer.css" rel="stylesheet" />



    @*WebTemplates links*@
    <link rel="stylesheet" href="~/Web/assets/vendors/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="~/Web/assets/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="~/Web/assets/css/style.css">


    <script src="~/js/toaster.js"></script>
    <link href="~/css/toaster.css" rel="stylesheet" />

    <script type="text/javascript" src="~/js/FileSaver.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/7.10.1/polyfill.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/3.8.0/exceljs.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.3.1/jspdf.umd.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.14/jspdf.plugin.autotable.min.js"></script>

</head>
<body>
    <div class="container-scroller">
        <!--<main role="main" class="pb-3">-->
        <partial name="_LoginPartial" />
        <div class="container-fluid page-body-wrapper">
            <partial name="_Menubar" />
            <div class="main-panel">
                <div class="content-wrapper">
                    <div class="row" id="proBanner" style="display:none;">
                        <div class="col-12">
                            <span class="d-flex align-items-center purchase-popup">
                                <i class="mdi mdi-close" id="bannerClose"></i>
                            </span>
                        </div>
                    </div>
                    @RenderBody()
                </div>

                <footer class="footer">
                    <div class="d-sm-flex justify-content-center justify-content-sm-between">
                        <span class="text-muted text-center text-sm-left d-block d-sm-inline-block">Copyright © 2022 . All rights reserved.</span>
                     </div>
                </footer>

            </div>
        </div>
        @*</main>*@
    </div>


    @RenderSection("Scripts", required: false)

    <!-- plugins:js -->
    <!--<script src="~/Web/assets/vendors/js/vendor.bundle.base.js"></script>-->
    <!-- endinject -->
    <!-- Plugin js for this page -->
    <script src="~/Web/assets/vendors/chart.js/Chart.min.js"></script>
    <!-- End plugin js for this page -->
    <!-- inject:js -->
    <script src="~/Web/assets/js/off-canvas.js"></script>
    <script src="~/Web/assets/js/hoverable-collapse.js"></script>
    <script src="~/Web/assets/js/misc.js"></script>
    <!-- endinject -->
    <!-- Custom js for this page -->
    <script src="~/Web/assets/js/dashboard.js"></script>
    <script src="~/Web/assets/js/todolist.js"></script>
    <!-- End custom js for this page -->
    <script>
        var usr = new Array();
         var pagEs;

        $(function () {
            GetCurrentUser();
            GetassignedPermission();
         });

        function GetassignedPermission() {

                //****Get Current User with roles*****
         $.get('@Url.Action("CurrentUserList", "Admin")', function (data) {
            var roles = data;
               console.log(roles.result, "result roLes");

             // **** Get All Assigned Pages By Role ***
          var a =  $.post('@Url.Action("GetPagePermission", "Admin")', { role: roles.result }, function (data) {
                var menu = data;

                // **** Prevent duplicates ***
                pagEs = menu.reduce((unique, o) => {
                     if (!unique.some(obj => obj.PageName === o.PageName)) {
                         unique.push(o);
                     }
                     return unique;
                }, []); 
              localStorage.setItem('Pages', JSON.stringify(pagEs));
          }); 
         }); 
    }

           function GetCurrentUser() {
               $.get('@Url.Action("CurrentUser", "Admin")', function (data) {
             localStorage.setItem('User', JSON.stringify(data));
                   localStorage.setItem('userCompany', JSON.stringify(data.CompanyId));

               });
      }
    </script>
</body>

</html>
